<html>
    <head>
        <title>ВычМат лаб 1</title>
        <link id="stylesheet" rel="stylesheet" type="text/css" href="assets/css/style.css" disabled>
    </head>
    <body>
        <header>
            <h1 style="font-family: Monomakh, sans-serif;">
                Вычислительная математика
            </h1>
            <ul>
                <li>Лабораторная работа №1</li>
                <li>Калиев Александр Дмитриевич</li>
                <li>P3211</li>
                <li>408724</li>
            </ul>
        </header>

        <button onclick="toggleStyles()" style="position: absolute; top: 10px; right: 10px;">Toggle styles</button>

        <main>
            <input type="number" id="n" placeholder="n" min="1" max="20" required>
            <button onclick="generateMatrix()">Generate Matrix</button>
            <div id="matrix-container"></div>
            <button onclick="calculate()">Calculate</button>
            
        </main>
    </body>


    <script>
        function toggleStyles() {
            var stylesheet = document.getElementById('stylesheet');
            if (stylesheet.disabled) {
                stylesheet.disabled = false;
            } else {
                stylesheet.disabled = true;
            }
        }
    </script>

    <script>
        function generateMatrix() {
            var n = document.getElementById('n').value;
            var container = document.getElementById('matrix-container');
            container.innerHTML = ''; // Clear previous matrix

            if (n < 1 || n > 20) {
                alert('Please enter a number between 1 and 20');
                return;
            }

            var table = document.createElement('table');
            table.style.tableLayout = 'fixed';
            for (var i = 0; i < n; i++) {
                var row = document.createElement('tr');
                for (var j = 0; j < n; j++) {
                    var cell = document.createElement('td');
                    var input = document.createElement('input');
                    input.type = 'text';
                    input.style.width = '70px'; 
                    input.style.height = '70px';
                    input.style.textAlign = 'center';
                    input.style.border = '1px solid black';
                    cell.appendChild(input);
                    row.appendChild(cell);
                }
                table.appendChild(row);
            }
            container.appendChild(table);
        }
    </script>
    
    <script>
        function calculate() {
            var container = document.getElementById('matrix-container');
            var rows = container.getElementsByTagName('tr');
            var matrix = [];

            for (var i = 0; i < rows.length; i++) {
                var cells = rows[i].getElementsByTagName('td');
                var row = [];
                for (var j = 0; j < cells.length; j++) {
                    var input = cells[j].getElementsByTagName('input')[0];
                    row.push(parseFloat(input.value) || 0);
                }
                matrix.push(row);
            }

            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/api', true);
            xhr.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    alert('Calculation result: ' + response.result);
                }
            };
            xhr.send(JSON.stringify({ matrix: matrix }));
        }
    </script>
</html>